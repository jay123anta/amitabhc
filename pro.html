<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AmitabhC Pro - Professional Bollywood IDE</title>
    
    <!-- PWA Meta -->
    <meta name="theme-color" content="#ff9933">
    <link rel="manifest" href="manifest.json">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üé¨</text></svg>">
    
    <!-- CodeMirror CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/codemirror.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/theme/dracula.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/hint/show-hint.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/javascript/javascript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/hint/show-hint.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/edit/matchbrackets.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/edit/closebrackets.min.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'JetBrains Mono', monospace;
            background: #0d1117;
            color: #e6edf3;
            height: 100vh;
            overflow: hidden;
        }

        /* Main App Layout */
        .app {
            display: grid;
            grid-template-rows: 64px 1fr 32px;
            height: 100vh;
            background: #0d1117;
        }

        /* Header */
        .header {
            background: linear-gradient(135deg, #1f2937 0%, #374151 100%);
            padding: 0 24px;
            display: flex;
            align-items: center;
            gap: 24px;
            border-bottom: 3px solid #ff9933;
            box-shadow: 0 4px 12px rgba(0,0,0,0.4);
        }

        .logo {
            font-size: 1.8em;
            font-weight: 900;
            color: #ff9933;
            text-shadow: 0 2px 4px rgba(255,153,51,0.3);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .logo::before {
            content: 'üé¨';
            font-size: 1.2em;
            animation: rotate 4s linear infinite;
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .controls {
            display: flex;
            gap: 16px;
            align-items: center;
        }

        .btn-primary {
            background: linear-gradient(135deg, #ff9933, #e67e00);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(255,153,51,0.3);
        }

        .btn-primary:hover {
            background: linear-gradient(135deg, #e67e00, #cc6600);
            transform: translateY(-1px);
            box-shadow: 0 6px 16px rgba(255,153,51,0.4);
        }

        .btn-secondary {
            background: #374151;
            color: #e5e7eb;
            border: 1px solid #4b5563;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 13px;
            transition: all 0.2s ease;
        }

        .btn-secondary:hover {
            background: #4b5563;
            border-color: #6b7280;
        }

        /* Main Content */
        .content {
            display: grid;
            grid-template-columns: 280px 1fr;
            overflow: hidden;
            background: #0d1117;
        }

        /* Sidebar */
        .sidebar {
            background: #161b22;
            border-right: 1px solid #30363d;
            display: grid;
            grid-template-rows: auto 1fr auto;
            overflow: hidden;
        }

        .sidebar-header {
            padding: 16px;
            border-bottom: 1px solid #30363d;
            background: #1c2128;
        }

        .sidebar-title {
            color: #ff9933;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
        }

        .file-explorer {
            padding: 8px;
            overflow-y: auto;
        }

        .file-item {
            padding: 10px 12px;
            cursor: pointer;
            border-radius: 6px;
            margin-bottom: 2px;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 13px;
            transition: all 0.2s ease;
            color: #e6edf3;
        }

        .file-item:hover {
            background: #21262d;
        }

        .file-item.active {
            background: rgba(255,153,51,0.15);
            color: #ff9933;
            border-left: 3px solid #ff9933;
        }

        .ai-panel {
            padding: 16px;
            border-top: 1px solid #30363d;
            background: #1c2128;
        }

        .ai-assistant {
            background: linear-gradient(135deg, #8b5cf6, #6366f1);
            padding: 12px;
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .ai-assistant:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(139,92,246,0.3);
        }

        /* Workspace */
        .workspace {
            display: grid;
            grid-template-rows: 48px minmax(300px, 1fr) minmax(200px, 400px);
            overflow: hidden;
            background: #0d1117;
        }

        /* Tabs */
        .tabs {
            background: #161b22;
            display: flex;
            border-bottom: 1px solid #30363d;
            padding: 0 12px;
            align-items: flex-end;
        }

        .tab {
            padding: 12px 20px;
            background: #21262d;
            color: #7d8590;
            cursor: pointer;
            border-radius: 8px 8px 0 0;
            margin-right: 4px;
            font-size: 13px;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.2s ease;
            position: relative;
            top: 1px;
        }

        .tab.active {
            background: #0d1117;
            color: #ff9933;
            border-bottom: 2px solid #ff9933;
        }

        .tab-close {
            margin-left: 8px;
            padding: 2px 4px;
            border-radius: 3px;
            opacity: 0.6;
        }

        .tab-close:hover {
            background: rgba(255,255,255,0.1);
            opacity: 1;
        }

        /* Editor */
        .editor-section {
            position: relative;
            overflow: hidden;
            background: #0d1117;
            min-height: 400px;
        }

        .CodeMirror {
            height: 100% !important;
            min-height: 400px !important;
            font-size: 16px;
            font-family: 'JetBrains Mono', 'Fira Code', 'Consolas', monospace;
            line-height: 1.6;
            background: #0d1117 !important;
            color: #e6edf3 !important;
        }

        .CodeMirror-focused .CodeMirror-cursor {
            border-color: #ff9933 !important;
        }

        .CodeMirror-selected {
            background: rgba(255,153,51,0.2) !important;
        }

        .CodeMirror-gutters {
            background: #161b22 !important;
            border-right: 1px solid #30363d !important;
        }

        .CodeMirror-linenumber {
            color: #7d8590 !important;
        }

        .CodeMirror-activeline-background {
            background: rgba(255,153,51,0.1) !important;
        }

        /* Output Section */
        .output-section {
            background: #0d1117;
            border-top: 2px solid #ff9933;
            display: grid;
            grid-template-rows: 48px 1fr;
            overflow: hidden;
        }

        .output-header {
            background: #161b22;
            padding: 0 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-bottom: 1px solid #30363d;
        }

        .output-title {
            font-weight: 600;
            color: #ff9933;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
        }

        .output-controls {
            display: flex;
            gap: 8px;
        }

        .output-body {
            padding: 16px;
            overflow-y: auto;
            font-family: 'JetBrains Mono', monospace;
            font-size: 14px;
            line-height: 1.5;
            background: #0d1117;
        }

        .output-line {
            margin-bottom: 8px;
            padding: 8px 12px;
            border-radius: 6px;
            border-left: 3px solid transparent;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .output-line.info {
            color: #58a6ff;
            background: rgba(88,166,255,0.1);
            border-left-color: #58a6ff;
        }

        .output-line.print {
            color: #e6edf3;
            background: rgba(255,153,51,0.1);
            border-left-color: #ff9933;
        }

        .output-line.success {
            color: #56d364;
            background: rgba(86,211,100,0.1);
            border-left-color: #56d364;
        }

        .output-line.error {
            color: #f85149;
            background: rgba(248,81,73,0.1);
            border-left-color: #f85149;
        }

        .output-line.warning {
            color: #d29922;
            background: rgba(210,153,34,0.1);
            border-left-color: #d29922;
        }

        .output-line.kbc {
            color: #ff9933;
            background: linear-gradient(90deg, rgba(255,153,51,0.1), rgba(255,153,51,0.05));
            border-left-color: #ff9933;
            border-radius: 8px;
            font-weight: 500;
        }

        /* Status Bar */
        .status {
            background: #161b22;
            padding: 0 20px;
            display: flex;
            align-items: center;
            gap: 20px;
            border-top: 1px solid #30363d;
            font-size: 12px;
            color: #7d8590;
        }

        .status-item {
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .status-item.ready {
            color: #56d364;
        }

        .status-item.error {
            color: #f85149;
        }

        /* Resize Handle */
        .resize-handle {
            position: absolute;
            top: -3px;
            left: 0;
            right: 0;
            height: 6px;
            background: transparent;
            cursor: ns-resize;
            z-index: 100;
        }

        .resize-handle:hover {
            background: rgba(255,153,51,0.3);
        }

        /* AI Chat Popup */
        .ai-chat {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 500px;
            height: 600px;
            background: #161b22;
            border: 1px solid #30363d;
            border-radius: 12px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
            display: none;
            grid-template-rows: 60px 1fr 60px;
            z-index: 1000;
        }

        .ai-chat.active {
            display: grid;
        }

        .ai-chat-header {
            padding: 16px 20px;
            border-bottom: 1px solid #30363d;
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: linear-gradient(135deg, #8b5cf6, #6366f1);
            border-radius: 12px 12px 0 0;
            color: white;
        }

        .ai-chat-title {
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .ai-chat-close {
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            padding: 4px;
            border-radius: 4px;
        }

        .ai-chat-close:hover {
            background: rgba(255,255,255,0.2);
        }

        .ai-messages {
            padding: 16px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .ai-message {
            padding: 12px 16px;
            border-radius: 8px;
            max-width: 80%;
        }

        .ai-message.user {
            align-self: flex-end;
            background: #ff9933;
            color: white;
        }

        .ai-message.ai {
            align-self: flex-start;
            background: #21262d;
            color: #e6edf3;
        }

        .ai-input-area {
            padding: 16px;
            border-top: 1px solid #30363d;
            display: flex;
            gap: 8px;
        }

        .ai-input {
            flex: 1;
            background: #21262d;
            border: 1px solid #30363d;
            color: #e6edf3;
            padding: 12px;
            border-radius: 6px;
            font-size: 14px;
        }

        .ai-send {
            background: #ff9933;
            color: white;
            border: none;
            padding: 12px 16px;
            border-radius: 6px;
            cursor: pointer;
        }

        /* Responsive Design */
        @media (max-width: 1024px) {
            .content {
                grid-template-columns: 240px 1fr;
            }
        }

        @media (max-width: 768px) {
            .content {
                grid-template-columns: 1fr;
            }
            
            .sidebar {
                display: none;
            }
            
            .ai-chat {
                width: 90vw;
                height: 80vh;
            }
        }

        /* Loading Animation */
        .loading {
            display: inline-block;
            width: 16px;
            height: 16px;
            border: 2px solid #30363d;
            border-top: 2px solid #ff9933;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        /* Scrollbar Styling */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #161b22;
        }

        ::-webkit-scrollbar-thumb {
            background: #30363d;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #484f58;
        }

        /* Tooltips */
        [data-tooltip] {
            position: relative;
        }

        [data-tooltip]:hover::after {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: #1c2128;
            color: #e6edf3;
            padding: 6px 8px;
            border-radius: 4px;
            font-size: 12px;
            white-space: nowrap;
            z-index: 1000;
            border: 1px solid #30363d;
        }
    </style>
</head>
<body>
    <div class="app">
        <!-- Header -->
        <div class="header">
            <div class="logo">
                AmitabhC Pro
                <span style="font-size: 0.7em; opacity: 0.8;">Professional IDE</span>
            </div>
            
            <div class="controls">
                <button class="btn-primary" onclick="runCode()" data-tooltip="Run Code (F5)">
                    ‚ñ∂Ô∏è Run
                </button>
                <button class="btn-secondary" onclick="toggleAI()" data-tooltip="AI Assistant">
                    ü§ñ AI
                </button>
                <button class="btn-secondary" onclick="exportCode()" data-tooltip="Export Code">
                    üì• Export
                </button>
                <button class="btn-secondary" onclick="saveToCloud()" data-tooltip="Save to Cloud">
                    ‚òÅÔ∏è Save
                </button>
            </div>
            
            <div style="margin-left: auto; display: flex; align-items: center; gap: 16px;">
                <span style="font-size: 12px; color: #7d8590;">
                    <span class="loading" id="loadingSpinner" style="display: none;"></span>
                    <span id="statusText">Ready</span>
                </span>
                <span style="font-size: 11px; color: #30363d;">v2.0</span>
            </div>
        </div>

        <!-- Main Content -->
        <div class="content">
            <!-- Sidebar -->
            <div class="sidebar">
                <div class="sidebar-header">
                    <div class="sidebar-title">
                        üìÅ Project Explorer
                    </div>
                </div>
                
                <div class="file-explorer">
                    <div class="file-item active" onclick="openFile('main.amitabhc')" data-file="main">
                        üé¨ main.amitabhc
                    </div>
                    <div class="file-item" onclick="openFile('examples.amitabhc')" data-file="examples">
                        üìö examples.amitabhc
                    </div>
                    <div class="file-item" onclick="openFile('functions.amitabhc')" data-file="functions">
                        ‚ö° functions.amitabhc
                    </div>
                    <div class="file-item" onclick="openFile('calculator.amitabhc')" data-file="calculator">
                        üßÆ calculator.amitabhc
                    </div>
                    <div class="file-item" onclick="openFile('kbc_game.amitabhc')" data-file="kbc">
                        üéØ kbc_game.amitabhc
                    </div>
                    <div class="file-item" onclick="openFile('kbc_advanced.amitabhc')" data-file="kbc_advanced">
                        üèÜ kbc_advanced.amitabhc
                    </div>
                    <div class="file-item" onclick="openFile('patterns.amitabhc')" data-file="patterns">
                        üåü patterns.amitabhc
                    </div>
                </div>
                
                <div class="ai-panel">
                    <div class="ai-assistant" onclick="toggleAI()">
                        <div style="font-weight: 600; margin-bottom: 4px;">ü§ñ AI Assistant</div>
                        <div style="font-size: 11px; opacity: 0.9;">Get coding help instantly</div>
                    </div>
                </div>
            </div>

            <!-- Workspace -->
            <div class="workspace">
                <!-- Tabs -->
                <div class="tabs">
                    <div class="tab active" id="currentTab">
                        üé¨ <span id="tabName">main.amitabhc</span>
                        <span class="tab-close" onclick="closeTab()">√ó</span>
                    </div>
                </div>

                <!-- Editor -->
                <div class="editor-section">
                    <textarea id="codeEditor">LIGHTS
CAMERA
    // üé¨ Welcome to AmitabhC Pro - Professional Bollywood IDE!
    DEVIYON_AUR_SAJJANO
    BOLO "Namaste! Welcome to AmitabhC Pro!"
    BOLO "Rishtey mein toh hum tumhare advanced compiler lagte hain!"
    
    // üé≠ Variable declarations with style
    VIJAY name = "Amitabh Bachchan"
    VIJAY age = 80
    DON films_count = 200
    
    BOLO "Superstar Details:"
    BOLO "Name: " + name
    BOLO "Age: " + age + " years"
    BOLO "Films: " + films_count + " movies"
    
    // üéØ Conditional logic
    AGAR age > 75
        BOLO "Main hoon ek living legend!"
        BOLO "Experience ka koi shortcut nahi hota beta!"
    NAHI TOH
        BOLO "Abhi toh main jawaan hoon!"
    BAS
    
    // üîÑ Loop demonstration
    BOLO "\nFamous Dialogues:"
    BAAR BAAR 3
        BOLO "- Don ko pakadna mushkil hi nahi, namumkin hai!"
    KHATAM
    
    // ‚ö° Function example
    NAAM greetAudience(message)
        BOLO "üé¨ " + message
        WAPAS SHAKTI
    PURA
    
    greetAudience("Keh diya, bas keh diya!")
    
    // üìä Array demonstration
    VIJAY iconic_movies[] = {"Sholay", "Deewar", "Don", "Agneepath", "Coolie"}
    BOLO "\nIconic Movies: " + iconic_movies
    
    // üéØ KBC Style Interactive
    BOLO "\n=== KBC Style Programming Quiz ==="
    COMPUTER_JI_LOCK_KIYA_JAYE
    BOLO "Successfully locked in the answer!"
    
    BOLO "\n‚ú® AmitabhC Pro Features Unlocked!"
    BOLO "- AI-Powered Code Assistance"
    BOLO "- Advanced Debugging Tools"
    BOLO "- Cloud Synchronization"
    BOLO "- Multi-format Export"
    BOLO "- Voice Coding Support"
    
ACTION</textarea>
                </div>

                <!-- Output Section -->
                <div class="output-section">
                    <div class="resize-handle" id="resizeHandle"></div>
                    
                    <div class="output-header">
                        <div class="output-title">
                            üì∫ Output Console
                        </div>
                        <div class="output-controls">
                            <button class="btn-secondary" onclick="clearOutput()" data-tooltip="Clear Console">
                                üóëÔ∏è
                            </button>
                            <button class="btn-secondary" onclick="toggleFullscreen()" data-tooltip="Toggle Fullscreen">
                                ‚õ∂
                            </button>
                        </div>
                    </div>
                    
                    <div class="output-body" id="outputBody">
                        <div class="output-line info">
                            ‚ú® AmitabhC Pro IDE is ready!
                        </div>
                        <div class="output-line info">
                            üé¨ "Jahan code shuru hota hai, wahin se programming ki line shuru hoti hai!"
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Status Bar -->
        <div class="status">
            <div class="status-item ready">
                <span>‚óè</span>
                <span id="mainStatus">Ready</span>
            </div>
            <div class="status-item">
                <span id="cursorPosition">Line 1, Col 1</span>
            </div>
            <div class="status-item">
                <span id="fileEncoding">UTF-8</span>
            </div>
            <div class="status-item">
                <span>AmitabhC</span>
            </div>
            <div style="margin-left: auto;">
                <span>Pro IDE v2.0</span>
            </div>
        </div>
    </div>

    <!-- AI Chat Popup -->
    <div class="ai-chat" id="aiChat">
        <div class="ai-chat-header">
            <div class="ai-chat-title">
                ü§ñ AmitabhC AI Assistant
            </div>
            <button class="ai-chat-close" onclick="toggleAI()">√ó</button>
        </div>
        
        <div class="ai-messages" id="aiMessages">
            <div class="ai-message ai">
                Namaste! I'm your AmitabhC AI assistant. I can help you with:
                <br>‚Ä¢ Code suggestions and debugging
                <br>‚Ä¢ Explaining AmitabhC syntax
                <br>‚Ä¢ KBC-style quiz questions
                <br>‚Ä¢ Best practices and optimization
                <br><br>How can I help you today?
            </div>
        </div>
        
        <div class="ai-input-area">
            <input type="text" class="ai-input" id="aiInput" placeholder="Ask me anything about AmitabhC..." onkeypress="handleAIEnter(event)">
            <button class="ai-send" onclick="sendAIMessage()">Send</button>
        </div>
    </div>

    <script>
        // Global Variables
        let editor;
        let currentFile = 'main.amitabhc';
        let isResizing = false;
        let startY, startHeight;
        
        // File Contents Database
        const fileContents = {
            'main.amitabhc': document.getElementById('codeEditor').value,
            'examples.amitabhc': `LIGHTS
CAMERA
    BOLO "üé¨ AmitabhC Examples Showcase!"
    BOLO "================================="
    
    // üìä Mathematics and Variables
    VIJAY num1 = 100
    VIJAY num2 = 42
    VIJAY result = num1 + num2
    BOLO "Mathematical Operation:"
    BOLO num1 + " + " + num2 + " = " + result
    
    // üéØ Conditional Logic
    VIJAY temperature = 35
    BOLO "\nWeather Check:"
    AGAR temperature > 30
        BOLO "üå°Ô∏è It's hot! Temperature: " + temperature + "¬∞C"
        BOLO "Garmi mein bhi hum cool rahe hain!"
    NAHI TOH AGAR temperature < 20
        BOLO "üå®Ô∏è It's cold! Bundle up!"
    NAHI TOH
        BOLO "üå§Ô∏è Perfect weather!"
    BAS
    
    // üîÑ Loop Demonstrations
    BOLO "\nCounting with BAAR BAAR:"
    BAAR BAAR 5
        BOLO "‚≠ê Superstar moment!"
    KHATAM
    
    BOLO "\nWhile loop with JAB TAK:"
    VIJAY countdown = 5
    JAB TAK countdown > 0
        BOLO "üöÄ Launch in " + countdown + " seconds"
        VIJAY countdown = countdown - 1
    RAHEGA
    BOLO "üé¨ Action!"
    
    // üìö Array Operations
    VIJAY movies[] = {"Sholay", "Deewar", "Don", "Agneepath"}
    BOLO "\nIconic Movies Array:"
    BOLO "Total movies: " + movies
    BOLO "First movie: " + movies[0]
    BOLO "Last movie: " + movies[3]
    
    BOLO "\n‚ú® Examples completed successfully!"
ACTION`,
            
            'functions.amitabhc': `LIGHTS
CAMERA
    BOLO "‚ö° AmitabhC Functions Masterclass!"
    BOLO "====================================="
    
    // üé≠ Simple Function
    NAAM greetBollywood()
        BOLO "üé¨ Welcome to Bollywood Programming!"
        BOLO "Lights, Camera, Code!"
    PURA
    
    // üßÆ Function with Parameters
    NAAM calculate(operation, a, b)
        AGAR operation == "add"
            VIJAY result = a + b
            BOLO a + " + " + b + " = " + result
        NAHI TOH AGAR operation == "multiply"
            VIJAY result = a * b
            BOLO a + " √ó " + b + " = " + result
        NAHI TOH
            BOLO "Unknown operation: " + operation
        BAS
    PURA
    
    // üéØ Function with Return Value
    NAAM getSuperheroName(realName)
        AGAR realName == "Amitabh"
            WAPAS "Shahenshah"
        NAHI TOH AGAR realName == "Vijay"
            WAPAS "Don"
        NAHI TOH
            WAPAS "Hero"
        BAS
    PURA
    
    // üî¢ Recursive Function
    NAAM factorial(n)
        AGAR n <= 1
            WAPAS 1
        NAHI TOH
            WAPAS n * factorial(n - 1)
        BAS
    PURA
    
    // üé™ Function Calls
    BOLO "=== Function Demonstrations ==="
    greetBollywood()
    
    BOLO "\n=== Calculator Functions ==="
    calculate("add", 25, 17)
    calculate("multiply", 8, 9)
    
    BOLO "\n=== Superhero Name Generator ==="
    VIJAY hero1 = getSuperheroName("Amitabh")
    VIJAY hero2 = getSuperheroName("Vijay")
    BOLO "Amitabh is known as: " + hero1
    BOLO "Vijay is known as: " + hero2
    
    BOLO "\n=== Factorial Calculator ==="
    VIJAY fact5 = factorial(5)
    VIJAY fact7 = factorial(7)
    BOLO "Factorial of 5: " + fact5
    BOLO "Factorial of 7: " + fact7
    
    BOLO "\nüéâ Function masterclass completed!"
ACTION`,
            
            'calculator.amitabhc': `LIGHTS
CAMERA
    BOLO "üßÆ AmitabhC Advanced Calculator"
    BOLO "================================"
    
    // üìä Calculator Functions
    NAAM add(x, y)
        WAPAS x + y
    PURA
    
    NAAM subtract(x, y)
        WAPAS x - y
    PURA
    
    NAAM multiply(x, y)
        WAPAS x * y
    PURA
    
    NAAM divide(x, y)
        AGAR y == 0
            BOLO "‚ùå Error: Division by zero!"
            WAPAS 0
        NAHI TOH
            WAPAS x / y
        BAS
    PURA
    
    NAAM power(base, exponent)
        VIJAY result = 1
        BAAR BAAR exponent
            VIJAY result = result * base
        KHATAM
        WAPAS result
    PURA
    
    // üéØ Calculator Demo
    VIJAY num1 = 144
    VIJAY num2 = 12
    
    BOLO "Calculator Input:"
    BOLO "Number 1: " + num1
    BOLO "Number 2: " + num2
    BOLO "------------------------"
    
    VIJAY sum = add(num1, num2)
    VIJAY difference = subtract(num1, num2)
    VIJAY product = multiply(num1, num2)
    VIJAY quotient = divide(num1, num2)
    VIJAY power_result = power(num2, 2)
    
    BOLO "‚ûï Addition: " + num1 + " + " + num2 + " = " + sum
    BOLO "‚ûñ Subtraction: " + num1 + " - " + num2 + " = " + difference
    BOLO "‚úñÔ∏è Multiplication: " + num1 + " √ó " + num2 + " = " + product
    BOLO "‚ûó Division: " + num1 + " √∑ " + num2 + " = " + quotient
    BOLO "üî¢ Power: " + num2 + "¬≤ = " + power_result
    
    // üìà Advanced Calculations
    BOLO "\n=== Advanced Calculations ==="
    VIJAY percentage = (num2 / num1) * 100
    BOLO "üìä " + num2 + " is " + percentage + "% of " + num1
    
    VIJAY average = (num1 + num2) / 2
    BOLO "üìä Average: " + average
    
    BOLO "\n‚úÖ Calculator operations completed!"
    BOLO "Hisaab kitaab ho gaya!"
ACTION`,
            
            'kbc_game.amitabhc': `LIGHTS
CAMERA
    // üéØ Kaun Banega Crorepati - AmitabhC Edition
    BOLO "üèÜ KAUN BANEGA CROREPATI - CODING EDITION üèÜ"
    BOLO "=============================================="
    DEVIYON_AUR_SAJJANO
    BOLO "Main hoon aapka host, Amitabh Bachchan!"
    BOLO "Aaj hum khelenge programming ka sabse bada quiz!"
    
    // üéÆ Game State
    VIJAY total_winnings = 0
    VIJAY current_question = 1
    VIJAY lifeline_5050 = SHAKTI
    VIJAY lifeline_audience = SHAKTI
    VIJAY lifeline_phone = SHAKTI
    
    // üí∞ Prize Money Ladder
    VIJAY prize_ladder[] = {1000, 5000, 10000, 50000, 100000, 500000, 1000000}
    
    BOLO "\nüéØ Question " + current_question + " for Rs. " + prize_ladder[0] + ":"
    BOLO "AmitabhC mein variable declare karne ke liye kya use hote hai?"
    BOLO "A) VAR    B) LET    C) VIJAY    D) VARIABLE"
    
    // üÜò Lifeline Options
    BOLO "\nüÜò Available Lifelines:"
    AGAR lifeline_5050 == SHAKTI
        BOLO "1Ô∏è‚É£ Fifty-Fifty"
    BAS
    AGAR lifeline_audience == SHAKTI
        BOLO "2Ô∏è‚É£ Audience Poll"
    BAS
    AGAR lifeline_phone == SHAKTI
        BOLO "3Ô∏è‚É£ Phone a Friend"
    BAS
    
    // üéØ Simulate lifeline usage
    BOLO "\nüé™ Using Audience Poll lifeline..."
    AUDIENCE_POLL
    BOLO "üìä 83% audience voted for option C!"
    VIJAY lifeline_audience = KAALIA
    
    // üí° Expert advice
    BOLO "\nüéì Let's also get expert advice..."
    EXPERT_ADVICE
    
    // üîí Lock the answer
    BOLO "\nüéØ Final Answer: C) VIJAY"
    CONFIDENT_TO_LOCK_KIYA_JAYE
    
    // ‚úÖ Correct Answer
    BOLO "\nüéâ BILKUL SAHI JAWAB!"
    COMPUTER_JI_LOCK_KIYA_JAYE
    VIJAY total_winnings = prize_ladder[0]
    BOLO "üèÜ Congratulations! You've won Rs. " + total_winnings + "!"
    
    // üéØ Question 2
    VIJAY current_question = 2
    BOLO "\n" + "=".repeat(50)
    BOLO "üéØ Question " + current_question + " for Rs. " + prize_ladder[1] + ":"
    BOLO "BOLO command ka use kya hai AmitabhC mein?"
    BOLO "A) Input    B) Output    C) Loop    D) Condition"
    
    // üÜò Use Phone a Friend
    BOLO "\nüìû Using Phone a Friend lifeline..."
    PHONE_A_FRIEND "Programming Expert"
    VIJAY lifeline_phone = KAALIA
    
    BOLO "\nüéØ Final Answer: B) Output"
    CONFIDENT_TO_LOCK_KIYA_JAYE
    
    BOLO "\nüéâ OUTSTANDING! Another correct answer!"
    COMPUTER_JI_LOCK_KIYA_JAYE
    VIJAY total_winnings = prize_ladder[1]
    
    // üèÅ Game Summary
    BOLO "\n" + "=".repeat(50)
    BOLO "üèÜ GAME SUMMARY"
    BOLO "==============="
    BOLO "Questions Answered: " + current_question
    BOLO "Total Winnings: Rs. " + total_winnings
    BOLO "Lifelines Used: " + (3 - (lifeline_5050 + lifeline_audience + lifeline_phone))
    
    AGAR total_winnings >= 5000
        BOLO "\nüåü EXCELLENT PERFORMANCE!"
        BOLO "Aap ek true AmitabhC programmer hain!"
    NAHI TOH
        BOLO "\nüëç Good effort! Keep learning AmitabhC!"
    BAS
    
    BOLO "\nüé¨ Thank you for playing KBC - Coding Edition!"
    BOLO "Milte hain phir, nayi programming adventures ke saath!"
    BOLO "Dhanyawad!"
ACTION`,
            
            'kbc_advanced.amitabhc': `LIGHTS
CAMERA
    // üèÜ KBC Advanced - The Ultimate Programming Challenge
    BOLO "üé™ KAUN BANEGA CROREPATI - ADVANCED EDITION üé™"
    BOLO "==============================================="
    DEVIYON_AUR_SAJJANO
    BOLO "Welcome to the most challenging programming quiz!"
    BOLO "Aaj ka sawaal hai - Can you become a Crorepati coder?"
    
    // üéÆ Advanced Game State
    VIJAY player_score = 0
    VIJAY question_level = 1
    VIJAY difficulty_multiplier = 1
    VIJAY bonus_points = 0
    
    // üèÜ Advanced Prize Structure
    VIJAY mega_prizes[] = {1000, 5000, 10000, 50000, 100000, 500000, 1000000, 5000000}
    
    // üÜò Enhanced Lifelines
    VIJAY lifeline_5050 = SHAKTI
    VIJAY lifeline_audience = SHAKTI
    VIJAY lifeline_phone = SHAKTI
    VIJAY lifeline_expert = SHAKTI
    VIJAY lifeline_google = SHAKTI  // Special lifeline!
    
    // üéØ Question Bank Function
    NAAM askAdvancedQuestion(level)
        AGAR level == 1
            BOLO "üî• Advanced Question " + level + " for Rs. " + mega_prizes[level-1] + ":"
            BOLO "What does 'JAB TAK' create in AmitabhC?"
            BOLO "A) For Loop    B) While Loop    C) If Condition    D) Function"
            WAPAS "B"
        NAHI TOH AGAR level == 2
            BOLO "üî• Advanced Question " + level + " for Rs. " + mega_prizes[level-1] + ":"
            BOLO "Which command is used for function return?"
            BOLO "A) RETURN    B) WAPAS    C) BACK    D) END"
            WAPAS "B"
        NAHI TOH AGAR level == 3
            BOLO "üî• Expert Question " + level + " for Rs. " + mega_prizes[level-1] + ":"
            BOLO "What represents 'true' in AmitabhC?"
            BOLO "A) TRUE    B) SHAKTI    C) YES    D) ON"
            WAPAS "B"
        NAHI TOH
            BOLO "üèÜ JACKPOT Question for Rs. " + mega_prizes[level-1] + ":"
            BOLO "What does 'DEVIYON_AUR_SAJJANO' do?"
            BOLO "A) Print    B) Input    C) Greeting    D) Exit"
            WAPAS "C"
        BAS
    PURA
    
    // üÜò Enhanced Lifeline System
    NAAM useAdvancedLifeline(type)
        AGAR type == "5050" && lifeline_5050 == SHAKTI
            LIFELINE_FIFTY_FIFTY
            BOLO "üí° 50-50 activated! Two options eliminated!"
            VIJAY lifeline_5050 = KAALIA
        NAHI TOH AGAR type == "audience" && lifeline_audience == SHAKTI
            AUDIENCE_POLL
            VIJAY poll_result = 65 + (question_level * 5)
            BOLO "üìä " + poll_result + "% audience confidence in correct answer!"
            VIJAY lifeline_audience = KAALIA
        NAHI TOH AGAR type == "phone" && lifeline_phone == SHAKTI
            PHONE_A_FRIEND "AmitabhC Master Programmer"
            BOLO "üìû Expert says: 'Based on AmitabhC syntax, I'm confident about the answer!'"
            VIJAY lifeline_phone = KAALIA
        NAHI TOH AGAR type == "expert" && lifeline_expert == SHAKTI
            EXPERT_ADVICE
            BOLO "üéì Deep analysis suggests this is a fundamental AmitabhC concept!"
            VIJAY lifeline_expert = KAALIA
        NAHI TOH
            BOLO "‚ùå Lifeline not available or already used!"
        BAS
    PURA
    
    // üéÆ Main Game Loop
    BOLO "\nüé™ Let the advanced challenge begin!"
    
    // üéØ Question 1
    VIJAY correct_answer = askAdvancedQuestion(1)
    useAdvancedLifeline("audience")
    
    BOLO "\nü§î Thinking time... What's your final answer?"
    CONFIDENT_TO_LOCK_KIYA_JAYE
    
    BOLO "‚úÖ Correct! SHABASH!"
    COMPUTER_JI_LOCK_KIYA_JAYE
    VIJAY player_score = mega_prizes[0]
    VIJAY bonus_points = bonus_points + 100
    
    // üéØ Question 2
    VIJAY question_level = 2
    VIJAY correct_answer = askAdvancedQuestion(2)
    useAdvancedLifeline("phone")
    
    BOLO "\nüéØ This is getting serious! Lock your answer?"
    CONFIDENT_TO_LOCK_KIYA_JAYE
    
    BOLO "üéâ FANTASTIC! You're on fire!"
    COMPUTER_JI_LOCK_KIYA_JAYE
    VIJAY player_score = mega_prizes[1]
    VIJAY bonus_points = bonus_points + 250
    
    // üéØ Expert Level Question
    VIJAY question_level = 3
    BOLO "\nüî• Now entering EXPERT TERRITORY!"
    BOLO "Wrong answer means you lose everything!"
    
    VIJAY correct_answer = askAdvancedQuestion(3)
    useAdvancedLifeline("expert")
    useAdvancedLifeline("5050")
    
    BOLO "\n‚ö° FINAL MOMENT! Are you absolutely sure?"
    CONFIDENT_TO_LOCK_KIYA_JAYE
    
    BOLO "üèÜ INCREDIBLE! YOU'RE A PROGRAMMING GENIUS!"
    COMPUTER_JI_LOCK_KIYA_JAYE
    VIJAY player_score = mega_prizes[2]
    VIJAY bonus_points = bonus_points + 500
    
    // üèÅ Grand Finale
    BOLO "\n" + "üåü".repeat(30)
    BOLO "üèÜ GRAND FINALE RESULTS üèÜ"
    BOLO "=========================="
    BOLO "Final Score: Rs. " + player_score
    BOLO "Bonus Points: " + bonus_points
    VIJAY total_achievement = player_score + bonus_points
    BOLO "Total Achievement: Rs. " + total_achievement
    
    BOLO "\nüé™ Performance Analysis:"
    AGAR player_score >= 10000
        BOLO "üåü OUTSTANDING! AmitabhC EXPERT level achieved!"
        BOLO "You deserve the title: 'Shahenshah of Coding'!"
    NAHI TOH AGAR player_score >= 5000
        BOLO "üéØ EXCELLENT! Advanced programmer status!"
        BOLO "Title earned: 'Don of AmitabhC'!"
    NAHI TOH
        BOLO "üëç GOOD EFFORT! Keep practicing!"
        BOLO "Title: 'Rising Star Programmer'!"
    BAS
    
    // üé¨ Epic Conclusion
    BOLO "\nüé¨ Yeh kahani khatam nahi hui..."
    BOLO "AmitabhC programming adventure continues!"
    BOLO "Keep coding, keep learning, keep growing!"
    BOLO "\n'Jab tak programming hai, tab tak AmitabhC hai!'"
    BOLO "Thank you for playing KBC Advanced Edition!"
    
    // üéä Victory Dance
    BAAR BAAR 3
        BOLO "üéâ CELEBRATION TIME! üéâ"
    KHATAM
    
ACTION`,
            
            'patterns.amitabhc': `LIGHTS
CAMERA
    BOLO "üåü AmitabhC Pattern Programming Showcase!"
    BOLO "========================================"
    
    // üî∑ Pattern 1: Simple Square
    BOLO "\nüìê Pattern 1: Square Matrix"
    BOLO "- - - - -"
    BAAR BAAR 5
        BAAR BAAR 5
            BOLO "‚≠ê "
        KHATAM
        BOLO ""  // New line
    KHATAM
    
    // üî∫ Pattern 2: Right Triangle
    BOLO "\nüìê Pattern 2: Right Triangle"
    BOLO "- - - - - - - - - -"
    VIJAY row = 1
    JAB TAK row <= 6
        VIJAY col = 1
        JAB TAK col <= row
            BOLO "üî∏ "
            VIJAY col = col + 1
        RAHEGA
        BOLO ""
        VIJAY row = row + 1
    RAHEGA
    
    // üíé Pattern 3: Diamond Shape
    BOLO "\nüìê Pattern 3: Diamond Shape"
    BOLO "- - - - - - - - - -"
    
    // Upper half of diamond
    VIJAY i = 1
    JAB TAK i <= 4
        VIJAY spaces = 1
        JAB TAK spaces <= (4 - i)
            BOLO "  "
            VIJAY spaces = spaces + 1
        RAHEGA
        
        VIJAY stars = 1
        JAB TAK stars <= (2 * i - 1)
            BOLO "üíé "
            VIJAY stars = stars + 1
        RAHEGA
        
        BOLO ""
        VIJAY i = i + 1
    RAHEGA
    
    // Lower half of diamond
    VIJAY j = 3
    JAB TAK j >= 1
        VIJAY spaces = 1
        JAB TAK spaces <= (4 - j)
            BOLO "  "
            VIJAY spaces = spaces + 1
        RAHEGA
        
        VIJAY stars = 1
        JAB TAK stars <= (2 * j - 1)
            BOLO "üíé "
            VIJAY stars = stars + 1
        RAHEGA
        
        BOLO ""
        VIJAY j = j - 1
    RAHEGA
    
    // üî¢ Pattern 4: Number Pyramid
    BOLO "\nüìê Pattern 4: Number Pyramid"
    BOLO "- - - - - - - - - -"
    VIJAY level = 1
    JAB TAK level <= 5
        VIJAY num = 1
        JAB TAK num <= level
            BOLO num + " "
            VIJAY num = num + 1
        RAHEGA
        BOLO ""
        VIJAY level = level + 1
    RAHEGA
    
    // üé≠ Pattern 5: Bollywood Style
    BOLO "\nüé¨ Pattern 5: Bollywood Special"
    BOLO "- - - - - - - - - -"
    VIJAY bollywood_row = 1
    JAB TAK bollywood_row <= 4
        AGAR bollywood_row == 1
            BOLO "    üé¨ AMITABH üé¨"
        NAHI TOH AGAR bollywood_row == 2
            BOLO "  üåü BACHCHAN üåü"
        NAHI TOH AGAR bollywood_row == 3
            BOLO "üé≠ SUPERSTAR üé≠"
        NAHI TOH
            BOLO "üèÜ LEGEND üèÜ"
        BAS
        BOLO ""
        VIJAY bollywood_row = bollywood_row + 1
    RAHEGA
    
    // üåà Pattern 6: Colorful ASCII Art
    BOLO "\nüé® Pattern 6: ASCII Art Banner"
    BOLO "- - - - - - - - - -"
    BOLO "  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó"
    BOLO " ‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ïê‚ïù ‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ïê‚ïù"
    BOLO " ‚ñà‚ñà‚ïë      ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó  "
    BOLO " ‚ñà‚ñà‚ïë      ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ïù  "
    BOLO " ‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó"
    BOLO "  ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù  ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù"
    
    // üéØ Interactive Pattern Generator
    BOLO "\nüéØ Interactive Pattern Generator"
    BOLO "================================"
    
    NAAM generateCustomPattern(size, symbol)
        BOLO "Custom Pattern (Size: " + size + ", Symbol: " + symbol + "):"
        VIJAY pattern_row = 1
        JAB TAK pattern_row <= size
            VIJAY pattern_col = 1
            JAB TAK pattern_col <= pattern_row
                BOLO symbol + " "
                VIJAY pattern_col = pattern_col + 1
            RAHEGA
            BOLO ""
            VIJAY pattern_row = pattern_row + 1
        RAHEGA
    PURA
    
    // Test custom pattern generator
    generateCustomPattern(6, "üî•")
    
    BOLO "\n‚ú® Pattern showcase completed!"
    BOLO "üé¨ Patterns mein bhi Bollywood ka jadoo!"
    BOLO "Keep creating beautiful patterns with AmitabhC!"
ACTION`
        };

        // Initialize CodeMirror Editor
        window.addEventListener('DOMContentLoaded', function() {
            const textarea = document.getElementById('codeEditor');
            
            editor = CodeMirror.fromTextArea(textarea, {
                mode: 'javascript',
                theme: 'dracula',
                lineNumbers: true,
                lineWrapping: true,
                matchBrackets: true,
                autoCloseBrackets: true,
                indentUnit: 4,
                tabSize: 4,
                styleActiveLine: true,
                viewportMargin: Infinity,
                extraKeys: {
                    "F5": function() { runCode(); },
                    "Ctrl-Space": "autocomplete",
                    "Ctrl-S": function() { saveToCloud(); },
                    "Ctrl-/": "toggleComment"
                }
            });
            
            // Set editor size explicitly
            editor.setSize("100%", "400px");
            
            // Update cursor position
            editor.on('cursorActivity', function() {
                const cursor = editor.getCursor();
                document.getElementById('cursorPosition').textContent = `Line ${cursor.line + 1}, Col ${cursor.ch + 1}`;
            });
            
            // Auto-refresh editor
            setTimeout(() => {
                editor.refresh();
                forceEditorResize();
            }, 100);
            
            // Setup resize functionality
            setupResize();
            
            // Initialize AI responses
            initializeAI();
            
            // Load default file
            openFile('main.amitabhc');
        });

        // Force editor to take full space
        function forceEditorResize() {
            if (editor) {
                const editorSection = document.querySelector('.editor-section');
                const height = editorSection.offsetHeight;
                editor.setSize("100%", Math.max(400, height - 10) + "px");
                editor.refresh();
            }
        }

        // Resize observer to handle dynamic sizing
        if (window.ResizeObserver) {
            const resizeObserver = new ResizeObserver(entries => {
                forceEditorResize();
            });
            
            setTimeout(() => {
                const editorSection = document.querySelector('.editor-section');
                if (editorSection) {
                    resizeObserver.observe(editorSection);
                }
            }, 500);
        }

        // File Management
        function openFile(filename) {
            // Save current file
            if (editor) {
                fileContents[currentFile] = editor.getValue();
            }
            
            // Update UI
            document.querySelectorAll('.file-item').forEach(item => {
                item.classList.remove('active');
                if (item.getAttribute('data-file') === filename.replace('.amitabhc', '')) {
                    item.classList.add('active');
                }
            });
            
            // Load new file
            currentFile = filename;
            if (editor) {
                editor.setValue(fileContents[filename] || '// New file');
                document.getElementById('tabName').textContent = filename;
            }
            
            updateStatus('File opened: ' + filename);
        }

        function closeTab() {
            // In a real implementation, you'd handle multiple tabs
            updateStatus('Tab management - Pro feature');
        }

        // Code Execution
        async function runCode() {
            if (!editor) {
                addOutput('‚ùå Editor not initialized!', 'error');
                return;
            }
            
            const code = editor.getValue().trim();
            
            if (!code) {
                addOutput('üìù Please write some AmitabhC code first!', 'warning');
                return;
            }
            
            clearOutput();
            updateStatus('Running...');
            
            // Show loading
            document.getElementById('loadingSpinner').style.display = 'inline-block';
            document.getElementById('statusText').textContent = 'Running...';
            
            addOutput('üé¨ Lights... Camera... Action!', 'info');
            addOutput('üöÄ Starting AmitabhC program execution...', 'info');
            
            try {
                // Create interpreter and run
                const interpreter = new AmitabhCProInterpreter();
                await interpreter.run(code);
                
                addOutput('‚úÖ Program executed successfully!', 'success');
                addOutput('üé¨ "Keh diya, bas keh diya!" - Program completed!', 'success');
                updateStatus('Ready');
                
            } catch (error) {
                console.error('Execution error:', error);
                addOutput(`‚ùå Runtime Error: ${error.message}`, 'error');
                addOutput('üîß Check your AmitabhC syntax and try again!', 'warning');
                updateStatus('Error', 'error');
            } finally {
                document.getElementById('loadingSpinner').style.display = 'none';
                document.getElementById('statusText').textContent = updateStatus.lastStatus || 'Ready';
            }
        }

        // Enhanced AmitabhC Interpreter
        class AmitabhCProInterpreter {
            constructor() {
                this.variables = {};
                this.constants = {};
                this.functions = {};
                this.arrays = {};
                this.callStack = [];
                this.maxCallDepth = 100;
                this.executionTime = 0;
                this.startTime = Date.now();
            }

            async run(code) {
                this.startTime = Date.now();
                const lines = code.split('\n').map(line => line.trim()).filter(line => line && !line.startsWith('//'));
                
                if (lines.length === 0) {
                    addOutput('üìù Empty program - Add some AmitabhC code!', 'warning');
                    return;
                }
                
                if (lines[0] !== 'LIGHTS') {
                    throw new Error("üé¨ Program must start with LIGHTS!");
                }
                if (lines[lines.length - 1] !== 'ACTION') {
                    throw new Error("üé¨ Program must end with ACTION!");
                }
                if (!lines.includes('CAMERA')) {
                    throw new Error("üé¨ Missing CAMERA section!");
                }

                const cameraIndex = lines.indexOf('CAMERA');
                const actionIndex = lines.indexOf('ACTION');
                const programLines = lines.slice(cameraIndex + 1, actionIndex);

                await this.executeBlock(programLines);
                this.executionTime = Date.now() - this.startTime;
                
                // Show execution stats
                addOutput(`‚è±Ô∏è Execution completed in ${this.executionTime}ms`, 'info');
            }

            async executeBlock(lines, startIndex = 0, endIndex = lines.length) {
                let i = startIndex;
                while (i < endIndex) {
                    const line = lines[i];
                    
                    try {
                        if (line.startsWith('BOLO')) {
                            this.executeBolo(line);
                        }
                        else if (line.startsWith('SUNO')) {
                            this.executeSuno(line);
                        }
                        else if (line.startsWith('VIJAY')) {
                            this.executeVijay(line);
                        }
                        else if (line.startsWith('DON')) {
                            this.executeDon(line);
                        }
                        else if (line.startsWith('AGAR')) {
                            i = await this.executeAgar(lines, i);
                            i--; // Adjust for loop increment
                        }
                        else if (line.startsWith('BAAR BAAR')) {
                            i = await this.executeBaarBaar(lines, i);
                            i--; // Adjust for loop increment
                        }
                        else if (line.startsWith('JAB TAK')) {
                            i = await this.executeJabTak(lines, i);
                            i--; // Adjust for loop increment
                        }
                        else if (line.startsWith('NAAM')) {
                            i = this.defineFunction(lines, i);
                            i--; // Adjust for loop increment
                        }
                        else if (line.startsWith('INTEZAAR')) {
                            await this.executeIntezaar(line);
                        }
                        // KBC Commands
                        else if (line.startsWith('COMPUTER_JI_LOCK_KIYA_JAYE')) {
                            addOutput('üíª Computer ji, lock kiya jaaye! Answer locked! ‚úÖ', 'kbc');
                        }
                        else if (line.startsWith('DEVIYON_AUR_SAJJANO')) {
                            addOutput('üéØ Deviyon aur Sajjano, welcome to AmitabhC program! üé¨', 'kbc');
                        }
                        else if (line.startsWith('CONFIDENT_TO_LOCK_KIYA_JAYE')) {
                            const confidence = confirm('ü§î Are you confident to lock this answer?');
                            if (confidence) {
                                addOutput('‚úÖ Answer confidently locked!', 'kbc');
                            } else {
                                addOutput('ü§∑ Taking more time to think...', 'kbc');
                            }
                        }
                        else if (line.startsWith('LIFELINE_FIFTY_FIFTY')) {
                            addOutput('üéØ 50-50 Lifeline Used! Two wrong options eliminated! üí°', 'kbc');
                        }
                        else if (line.startsWith('AUDIENCE_POLL')) {
                            const poll = Math.floor(Math.random() * 30) + 60;
                            addOutput(`üìä Audience Poll Results: ${poll}% voted for the popular option! üë•`, 'kbc');
                        }
                        else if (line.startsWith('PHONE_A_FRIEND')) {
                            const match = line.match(/PHONE_A_FRIEND\s+"(.+)"/);
                            const friend = match ? match[1] : 'Expert Friend';
                            addOutput(`üìû Calling ${friend} for help... Ring ring! üì±`, 'kbc');
                            setTimeout(() => {
                                addOutput(`${friend}: "Based on my knowledge, I'm confident about this answer!" üéì`, 'kbc');
                            }, 1000);
                        }
                        else if (line.startsWith('EXPERT_ADVICE')) {
                            addOutput('üéì Expert Advice: After careful analysis of AmitabhC syntax and logic, the pattern suggests this is the correct approach! üìö', 'kbc');
                        }
                        else if (line.startsWith('QUIT_GAME')) {
                            addOutput('üèÜ You have decided to quit and take your winnings! Bahut smart choice! üí∞', 'kbc');
                            throw new Error('Game quit by player - Smart decision!');
                        }
                        else if (line.includes('(') && line.includes(')')) {
                            this.executeFunctionCall(line);
                        }
                    } catch (error) {
                        addOutput(`‚ö†Ô∏è Line ${i + 1}: ${error.message}`, 'error');
                        throw error;
                    }
                    
                    i++;
                }
            }

            executeBolo(line) {
                const match = line.match(/BOLO\s+"([^"]*)"|BOLO\s+(.+)/);
                if (match) {
                    const expression = match[1] || match[2];
                    const value = this.evaluateExpression(expression);
                    addOutput(value, 'print');
                }
            }

            executeSuno(line) {
                const match = line.match(/SUNO\s+(\w+)/);
                if (match) {
                    const varName = match[1];
                    const input = prompt(`üé§ Enter value for ${varName}:`);
                    if (input !== null) {
                        this.variables[varName] = isNaN(input) ? input : Number(input);
                        addOutput(`üì• Input received: ${varName} = ${this.variables[varName]}`, 'info');
                    }
                }
            }

            executeVijay(line) {
                // Handle arrays
                if (line.includes('[') && line.includes(']')) {
                    const arrayMatch = line.match(/VIJAY\s+(\w+)\[\]\s*=\s*{(.+)}/);
                    if (arrayMatch) {
                        const arrayName = arrayMatch[1];
                        const elements = arrayMatch[2].split(',').map(e => this.evaluateExpression(e.trim()));
                        this.arrays[arrayName] = elements;
                        this.variables[arrayName] = elements;
                        addOutput(`üìä Array created: ${arrayName}[${elements.length}]`, 'info');
                        return;
                    }
                }
                
                const match = line.match(/VIJAY\s+(\w+)\s*=\s*(.+)/);
                if (match) {
                    const varName = match[1];
                    const expression = match[2];
                    this.variables[varName] = this.evaluateExpression(expression);
                    addOutput(`üíæ Variable set: ${varName} = ${this.variables[varName]}`, 'info');
                }
            }

            executeDon(line) {
                const match = line.match(/DON\s+(\w+)\s*=\s*(.+)/);
                if (match) {
                    const constName = match[1];
                    const expression = match[2];
                    this.constants[constName] = this.evaluateExpression(expression);
                    this.variables[constName] = this.constants[constName]; // Also store in variables for access
                    addOutput(`üîí Constant defined: ${constName} = ${this.constants[constName]}`, 'info');
                }
            }

            executeAgar(lines, startIndex) {
                const condition = lines[startIndex].replace('AGAR', '').trim();
                let i = startIndex + 1;
                let basIndex = -1;
                let nahiTohIndices = [];
                let depth = 1;
                
                // Find matching BAS and NAHI TOH
                for (let j = i; j < lines.length; j++) {
                    if (lines[j].startsWith('AGAR')) depth++;
                    if (lines[j] === 'BAS') {
                        depth--;
                        if (depth === 0) {
                            basIndex = j;
                            break;
                        }
                    }
                    if ((lines[j] === 'NAHI TOH' || lines[j].startsWith('NAHI TOH AGAR')) && depth === 1) {
                        nahiTohIndices.push(j);
                    }
                }

                if (basIndex === -1) {
                    throw new Error("AGAR block must end with BAS!");
                }

                const conditionResult = this.evaluateCondition(condition);
                addOutput(`ü§î Condition check: ${condition} = ${conditionResult}`, 'info');
                
                if (conditionResult) {
                    const endIndex = nahiTohIndices.length > 0 ? nahiTohIndices[0] : basIndex;
                    this.executeBlock(lines, i, endIndex);
                } else {
                    // Handle NAHI TOH and NAHI TOH AGAR
                    for (let idx = 0; idx < nahiTohIndices.length; idx++) {
                        const nahiTohLine = lines[nahiTohIndices[idx]];
                        const nextNahiToh = nahiTohIndices[idx + 1] || basIndex;
                        
                        if (nahiTohLine.startsWith('NAHI TOH AGAR')) {
                            const elseIfCondition = nahiTohLine.replace('NAHI TOH AGAR', '').trim();
                            if (this.evaluateCondition(elseIfCondition)) {
                                this.executeBlock(lines, nahiTohIndices[idx] + 1, nextNahiToh);
                                break;
                            }
                        } else {
                            this.executeBlock(lines, nahiTohIndices[idx] + 1, basIndex);
                            break;
                        }
                    }
                }

                return basIndex + 1;
            }

            async executeBaarBaar(lines, startIndex) {
                const match = lines[startIndex].match(/BAAR BAAR\s+(\d+)/);
                if (!match) {
                    throw new Error("BAAR BAAR requires a number!");
                }

                const times = parseInt(match[1]);
                let i = startIndex + 1;
                let khatamIndex = -1;
                let depth = 1;

                // Find matching KHATAM
                for (let j = i; j < lines.length; j++) {
                    if (lines[j].startsWith('BAAR BAAR')) depth++;
                    if (lines[j] === 'KHATAM') {
                        depth--;
                        if (depth === 0) {
                            khatamIndex = j;
                            break;
                        }
                    }
                }

                if (khatamIndex === -1) {
                    throw new Error("BAAR BAAR must end with KHATAM!");
                }

                addOutput(`üîÑ Starting loop: ${times} iterations`, 'info');
                for (let count = 0; count < times; count++) {
                    this.executeBlock(lines, i, khatamIndex);
                    // Small delay for visual effect
                    if (times > 5 && count < times - 1) {
                        await new Promise(resolve => setTimeout(resolve, 50));
                    }
                }
                addOutput(`‚úÖ Loop completed: ${times} iterations done`, 'info');

                return khatamIndex + 1;
            }

            async executeJabTak(lines, startIndex) {
                const condition = lines[startIndex].replace('JAB TAK', '').trim();
                let i = startIndex + 1;
                let rahegaIndex = -1;
                let depth = 1;

                // Find matching RAHEGA
                for (let j = i; j < lines.length; j++) {
                    if (lines[j].startsWith('JAB TAK')) depth++;
                    if (lines[j] === 'RAHEGA') {
                        depth--;
                        if (depth === 0) {
                            rahegaIndex = j;
                            break;
                        }
                    }
                }

                if (rahegaIndex === -1) {
                    throw new Error("JAB TAK must end with RAHEGA!");
                }

                let loopCount = 0;
                addOutput(`üîÑ While loop started: ${condition}`, 'info');
                
                while (this.evaluateCondition(condition)) {
                    this.executeBlock(lines, i, rahegaIndex);
                    loopCount++;
                    
                    if (loopCount > 10000) {
                        throw new Error("Infinite loop detected! Loop exceeded 10,000 iterations.");
                    }
                    
                    // Brief pause for long loops
                    if (loopCount % 10 === 0) {
                        await new Promise(resolve => setTimeout(resolve, 10));
                    }
                }
                
                addOutput(`‚úÖ While loop completed: ${loopCount} iterations`, 'info');
                return rahegaIndex + 1;
            }

            defineFunction(lines, startIndex) {
                const match = lines[startIndex].match(/NAAM\s+(\w+)\s*\(([^)]*)\)/);
                if (!match) {
                    throw new Error("Invalid function definition!");
                }

                const funcName = match[1];
                const params = match[2].split(',').map(p => p.trim()).filter(p => p);
                
                let i = startIndex + 1;
                let puraIndex = -1;

                // Find matching PURA
                for (let j = i; j < lines.length; j++) {
                    if (lines[j] === 'PURA') {
                        puraIndex = j;
                        break;
                    }
                }

                if (puraIndex === -1) {
                    throw new Error("Function must end with PURA!");
                }

                this.functions[funcName] = {
                    params: params,
                    body: lines.slice(i, puraIndex)
                };

                addOutput(`‚ö° Function defined: ${funcName}(${params.join(', ')})`, 'info');
                return puraIndex + 1;
            }

            executeFunctionCall(line) {
                const match = line.match(/(\w+)\s*\(([^)]*)\)/);
                if (match) {
                    const funcName = match[1];
                    const args = match[2] ? match[2].split(',').map(a => this.evaluateExpression(a.trim())) : [];
                    
                    if (this.functions[funcName]) {
                        if (this.callStack.length >= this.maxCallDepth) {
                            throw new Error("Maximum recursion depth exceeded!");
                        }

                        const func = this.functions[funcName];
                        const oldVars = {...this.variables};
                        this.callStack.push(funcName);
                        
                        // Set parameters
                        func.params.forEach((param, index) => {
                            this.variables[param] = args[index] || '';
                        });
                        
                        addOutput(`üìû Calling function: ${funcName}`, 'info');
                        
                        let returnValue = undefined;
                        for (const bodyLine of func.body) {
                            if (bodyLine.startsWith('WAPAS')) {
                                returnValue = this.evaluateExpression(bodyLine.replace('WAPAS', '').trim());
                                addOutput(`‚Ü©Ô∏è Function returning: ${returnValue}`, 'info');
                                break;
                            } else {
                                this.executeBlock([bodyLine]);
                            }
                        }
                        
                        // Restore variables
                        this.variables = oldVars;
                        this.callStack.pop();
                        
                        // Handle assignment
                        const assignMatch = line.match(/VIJAY\s+(\w+)\s*=\s*(\w+)\(/);
                        if (assignMatch) {
                            this.variables[assignMatch[1]] = returnValue;
                        }
                    } else {
                        addOutput(`‚ö†Ô∏è Unknown function: ${funcName}`, 'warning');
                    }
                }
            }

            executeIntezaar(line) {
                const match = line.match(/INTEZAAR\s+(\d+)/);
                if (match) {
                    const seconds = parseInt(match[1]);
                    addOutput(`‚è≥ Waiting ${seconds} seconds... "Intezaar ka phal meetha hota hai"`, 'info');
                    // In a real implementation, this would actually pause
                }
            }

            evaluateExpression(expr) {
                expr = expr.trim();
                
                // String literal
                if (expr.startsWith('"') && expr.endsWith('"')) {
                    return expr.slice(1, -1);
                }
                
                // Number
                if (!isNaN(expr) && expr !== '') {
                    return Number(expr);
                }
                
                // Boolean constants
                if (expr === 'SHAKTI') return true;
                if (expr === 'KAALIA') return false;
                
                // Array literal
                if (expr.startsWith('[') && expr.endsWith(']')) {
                    const items = expr.slice(1, -1).split(',').map(item => {
                        return this.evaluateExpression(item.trim());
                    });
                    return items;
                }
                
                // Array with curly braces
                if (expr.startsWith('{') && expr.endsWith('}')) {
                    const items = expr.slice(1, -1).split(',').map(item => {
                        return this.evaluateExpression(item.trim());
                    });
                    return items;
                }
                
                // Array access
                if (expr.includes('[') && expr.includes(']')) {
                    const match = expr.match(/(\w+)\[(\d+)\]/);
                    if (match) {
                        const arrayName = match[1];
                        const index = parseInt(match[2]);
                        if (this.variables[arrayName] && Array.isArray(this.variables[arrayName])) {
                            return this.variables[arrayName][index];
                        }
                    }
                }
                
                // String concatenation and arithmetic
                if (expr.includes('+')) {
                    return this.evaluateArithmetic(expr, '+');
                }
                if (expr.includes('-') && !expr.startsWith('-')) {
                    return this.evaluateArithmetic(expr, '-');
                }
                if (expr.includes('*')) {
                    return this.evaluateArithmetic(expr, '*');
                }
                if (expr.includes('/')) {
                    return this.evaluateArithmetic(expr, '/');
                }
                if (expr.includes('%')) {
                    return this.evaluateArithmetic(expr, '%');
                }
                
                // Variable lookup
                if (this.variables.hasOwnProperty(expr)) {
                    const value = this.variables[expr];
                    if (Array.isArray(value)) {
                        return value.join(', ');
                    }
                    return value;
                }
                
                return expr;
            }

            evaluateArithmetic(expr, operator) {
                const parts = expr.split(operator);
                if (parts.length < 2) return expr;
                
                let result = this.evaluateExpression(parts[0].trim());
                
                for (let i = 1; i < parts.length; i++) {
                    const operand = this.evaluateExpression(parts[i].trim());
                    
                    switch (operator) {
                        case '+':
                            if (typeof result === 'string' || typeof operand === 'string') {
                                result = result.toString() + operand.toString();
                            } else {
                                result = Number(result) + Number(operand);
                            }
                            break;
                        case '-':
                            result = Number(result) - Number(operand);
                            break;
                        case '*':
                            result = Number(result) * Number(operand);
                            break;
                        case '/':
                            if (Number(operand) === 0) {
                                throw new Error("Division by zero!");
                            }
                            result = Number(result) / Number(operand);
                            break;
                        case '%':
                            result = Number(result) % Number(operand);
                            break;
                    }
                }
                
                return result;
            }

            evaluateCondition(condition) {
                // Handle logical operators
                if (condition.includes('&&')) {
                    const parts = condition.split('&&');
                    return parts.every(part => this.evaluateCondition(part.trim()));
                }
                
                if (condition.includes('||')) {
                    const parts = condition.split('||');
                    return parts.some(part => this.evaluateCondition(part.trim()));
                }
                
                // Comparison operators
                const operators = ['==', '!=', '>=', '<=', '>', '<'];
                for (const op of operators) {
                    if (condition.includes(op)) {
                        const [left, right] = condition.split(op).map(p => this.evaluateExpression(p.trim()));
                        
                        switch (op) {
                            case '==': return left == right;
                            case '!=': return left != right;
                            case '>=': return Number(left) >= Number(right);
                            case '<=': return Number(left) <= Number(right);
                            case '>': return Number(left) > Number(right);
                            case '<': return Number(left) < Number(right);
                        }
                    }
                }
                
                // Boolean value
                const value = this.evaluateExpression(condition);
                return value === true || value === 'SHAKTI' || value === 1;
            }
        }

        // Output Management
        function addOutput(text, type = 'print') {
            const outputBody = document.getElementById('outputBody');
            const line = document.createElement('div');
            line.className = `output-line ${type}`;
            
            // Add icons and styling based on type
            let icon = '';
            switch (type) {
                case 'print': icon = 'üí¨'; break;
                case 'info': icon = '‚ÑπÔ∏è'; break;
                case 'success': icon = '‚úÖ'; break;
                case 'error': icon = '‚ùå'; break;
                case 'warning': icon = '‚ö†Ô∏è'; break;
                case 'kbc': icon = 'üéØ'; break;
                default: icon = 'üìù';
            }
            
            line.innerHTML = `<span style="margin-right: 8px;">${icon}</span>${text}`;
            outputBody.appendChild(line);
            outputBody.scrollTop = outputBody.scrollHeight;
        }

        function clearOutput() {
            document.getElementById('outputBody').innerHTML = '';
            addOutput('Console cleared - Ready for new output! üßπ', 'info');
        }

        // UI Controls
        function toggleFullscreen() {
            const workspace = document.querySelector('.workspace');
            const currentGrid = workspace.style.gridTemplateRows;
            
            if (currentGrid.includes('0px')) {
                // Restore normal view
                workspace.style.gridTemplateRows = '48px minmax(300px, 1fr) minmax(200px, 400px)';
            } else {
                // Maximize output
                workspace.style.gridTemplateRows = '48px 0px 1fr';
            }
            
            if (editor) {
                setTimeout(() => editor.refresh(), 100);
            }
        }

        function updateStatus(message, type = 'ready') {
            const statusElement = document.getElementById('mainStatus');
            const statusItem = statusElement.parentElement;
            
            statusElement.textContent = message;
            statusItem.className = `status-item ${type}`;
        }

        // AI Assistant
        function toggleAI() {
            const aiChat = document.getElementById('aiChat');
            aiChat.classList.toggle('active');
            
            if (aiChat.classList.contains('active')) {
                document.getElementById('aiInput').focus();
            }
        }

        function sendAIMessage() {
            const input = document.getElementById('aiInput');
            const messages = document.getElementById('aiMessages');
            const userMessage = input.value.trim();
            
            if (!userMessage) return;
            
            // Add user message
            const userDiv = document.createElement('div');
            userDiv.className = 'ai-message user';
            userDiv.textContent = userMessage;
            messages.appendChild(userDiv);
            
            // Clear input
            input.value = '';
            
            // Generate AI response
            setTimeout(() => {
                const aiDiv = document.createElement('div');
                aiDiv.className = 'ai-message ai';
                aiDiv.innerHTML = generateAIResponse(userMessage);
                messages.appendChild(aiDiv);
                messages.scrollTop = messages.scrollHeight;
            }, 1000);
            
            messages.scrollTop = messages.scrollHeight;
        }

        function handleAIEnter(event) {
            if (event.key === 'Enter') {
                sendAIMessage();
            }
        }

        function generateAIResponse(message) {
            const lowerMessage = message.toLowerCase();
            
            if (lowerMessage.includes('error') || lowerMessage.includes('bug')) {
                return `üêõ For debugging AmitabhC code:<br>
                ‚Ä¢ Check if your program starts with LIGHTS and ends with ACTION<br>
                ‚Ä¢ Ensure CAMERA section is present<br>
                ‚Ä¢ Verify all AGAR blocks end with BAS<br>
                ‚Ä¢ Check if all loops (BAAR BAAR/JAB TAK) have proper endings<br>
                ‚Ä¢ Make sure function definitions end with PURA`;
            }
            
            if (lowerMessage.includes('syntax') || lowerMessage.includes('how')) {
                return `üìö AmitabhC Syntax Help:<br>
                ‚Ä¢ Variables: VIJAY name = "value"<br>
                ‚Ä¢ Constants: DON pi = 3.14<br>
                ‚Ä¢ Print: BOLO "Hello World"<br>
                ‚Ä¢ Input: SUNO variableName<br>
                ‚Ä¢ If: AGAR condition...BAS<br>
                ‚Ä¢ Loops: BAAR BAAR 5...KHATAM<br>
                ‚Ä¢ Functions: NAAM functionName()...PURA`;
            }
            
            if (lowerMessage.includes('kbc') || lowerMessage.includes('quiz')) {
                return `üéØ KBC Commands in AmitabhC:<br>
                ‚Ä¢ DEVIYON_AUR_SAJJANO - Program greeting<br>
                ‚Ä¢ COMPUTER_JI_LOCK_KIYA_JAYE - Lock answer<br>
                ‚Ä¢ LIFELINE_FIFTY_FIFTY - Use 50-50 lifeline<br>
                ‚Ä¢ AUDIENCE_POLL - Get audience opinion<br>
                ‚Ä¢ PHONE_A_FRIEND "name" - Call for help<br>
                ‚Ä¢ EXPERT_ADVICE - Get expert analysis`;
            }
            
            if (lowerMessage.includes('example') || lowerMessage.includes('sample')) {
                return `üí° Try these examples:<br>
                ‚Ä¢ Open "examples.amitabhc" for basic syntax<br>
                ‚Ä¢ Check "kbc_game.amitabhc" for interactive quiz<br>
                ‚Ä¢ Look at "functions.amitabhc" for advanced features<br>
                ‚Ä¢ Explore "patterns.amitabhc" for creative programming`;
            }
            
            return `ü§ñ I'm here to help with AmitabhC programming! You can ask me about:<br>
            ‚Ä¢ Syntax and commands<br>
            ‚Ä¢ Debugging errors<br>
            ‚Ä¢ Code examples<br>
            ‚Ä¢ KBC features<br>
            ‚Ä¢ Best practices<br><br>
            What specific help do you need? üé¨`;
        }

        function initializeAI() {
            // Add welcome message to AI
            const messages = document.getElementById('aiMessages');
            const welcomeMsg = document.createElement('div');
            welcomeMsg.className = 'ai-message ai';
            welcomeMsg.innerHTML = `üé¨ Welcome to AmitabhC Pro! I'm your AI coding assistant.<br><br>
            I can help you with:<br>
            ‚Ä¢ Writing and debugging AmitabhC code<br>
            ‚Ä¢ Understanding Bollywood programming concepts<br>
            ‚Ä¢ KBC-style interactive features<br>
            ‚Ä¢ Code optimization and best practices<br><br>
            Just ask me anything! "Jahan AI shuru hota hai, wahin se coding magic shuru hoti hai!" ‚ú®`;
            messages.appendChild(welcomeMsg);
        }

        // Advanced Features
        function exportCode() {
            if (!editor) return;
            
            const code = editor.getValue();
            const filename = currentFile || 'amitabhc_program.amitabhc';
            
            // Create download
            const blob = new Blob([code], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            addOutput(`üì• Code exported as ${filename}`, 'success');
            updateStatus('Code exported successfully');
        }

        function saveToCloud() {
            if (!editor) return;
            
            // Simulate cloud save
            const code = editor.getValue();
            localStorage.setItem('amitabhc_auto_save', code);
            localStorage.setItem('amitabhc_last_save', new Date().toISOString());
            
            addOutput('‚òÅÔ∏è Code auto-saved to browser storage', 'success');
            updateStatus('Auto-saved');
            
            // In a real implementation, this would save to actual cloud storage
            setTimeout(() => {
                addOutput('üíæ Backup created successfully', 'info');
            }, 1000);
        }

        // Resize functionality
        function setupResize() {
            const resizeHandle = document.getElementById('resizeHandle');
            const workspace = document.querySelector('.workspace');
            const outputSection = document.querySelector('.output-section');
            
            let isResizing = false;
            let startY = 0;
            let startHeight = 0;
            
            resizeHandle.addEventListener('mousedown', function(e) {
                isResizing = true;
                startY = e.clientY;
                startHeight = outputSection.offsetHeight;
                document.body.style.cursor = 'ns-resize';
                e.preventDefault();
            });
            
            document.addEventListener('mousemove', function(e) {
                if (!isResizing) return;
                
                const deltaY = startY - e.clientY;
                const newHeight = Math.min(Math.max(150, startHeight + deltaY), 700);
                
                // Update grid template
                const tabHeight = 48;
                const totalHeight = workspace.offsetHeight;
                const editorHeight = totalHeight - tabHeight - newHeight;
                
                workspace.style.gridTemplateRows = `${tabHeight}px ${editorHeight}px ${newHeight}px`;
                
                if (editor) {
                    editor.refresh();
                }
            });
            
            document.addEventListener('mouseup', function() {
                if (isResizing) {
                    isResizing = false;
                    document.body.style.cursor = '';
                }
            });
        }

        // Keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            // F5 - Run code
            if (e.key === 'F5') {
                e.preventDefault();
                runCode();
            }
            
            // Ctrl+S - Save to cloud
            if (e.ctrlKey && e.key === 's') {
                e.preventDefault();
                saveToCloud();
            }
            
            // Ctrl+E - Export code
            if (e.ctrlKey && e.key === 'e') {
                e.preventDefault();
                exportCode();
            }
            
            // Ctrl+` - Toggle AI
            if (e.ctrlKey && e.key === '`') {
                e.preventDefault();
                toggleAI();
            }
            
            // Esc - Close AI if open
            if (e.key === 'Escape') {
                const aiChat = document.getElementById('aiChat');
                if (aiChat.classList.contains('active')) {
                    toggleAI();
                }
            }
        });

        // Auto-save functionality
        setInterval(() => {
            if (editor) {
                saveToCloud();
            }
        }, 30000); // Auto-save every 30 seconds

        // Load saved code on startup
        window.addEventListener('load', () => {
            const savedCode = localStorage.getItem('amitabhc_auto_save');
            if (savedCode && editor) {
                const shouldRestore = confirm('üîÑ Found auto-saved code. Would you like to restore it?');
                if (shouldRestore) {
                    editor.setValue(savedCode);
                    addOutput('üîÑ Auto-saved code restored!', 'success');
                }
            }
            
            // Welcome message
            addOutput('üé¨ AmitabhC Pro IDE loaded successfully!', 'success');
            addOutput('Press F5 to run code, Ctrl+` for AI assistant', 'info');
        });
    </script>
</body>
</html>